var MS,AjaxPro,progids,progid,ie7xmlhttp,o;if(Object.extend(Function.prototype,{getArguments:function(){for(var t=[],n=0;n<this.arguments.length;n++)t.push(this.arguments[n]);return t}},!1),MS={Browser:{}},Object.extend(MS.Browser,{isIE:navigator.userAgent.indexOf("MSIE")!=-1,isFirefox:navigator.userAgent.indexOf("Firefox")!=-1,isOpera:window.opera!=null},!1),AjaxPro={},AjaxPro.IFrameXmlHttp=function(){},AjaxPro.IFrameXmlHttp.prototype={onreadystatechange:null,headers:[],method:"POST",url:null,"async":!0,iframe:null,status:0,readyState:0,responseText:null,abort:function(){},readystatechanged:function(){var n=this.iframe.contentDocument||this.iframe.document;if(n!=null&&n.readyState=="complete"&&n.body!=null&&n.body.res!=null){this.status=200;this.statusText="OK";this.readyState=4;this.responseText=n.body.res;this.onreadystatechange();return}setTimeout(this.readystatechanged.bind(this),10)},open:function(n,t,i){var u,r;if(i==!1){alert("Synchronous call using IFrameXMLHttp is not supported.");return}this.iframe==null&&(u="hans",document.createElement&&document.documentElement&&(window.opera||navigator.userAgent.indexOf("MSIE 5.0")==-1)?(r=document.createElement("iframe"),r.setAttribute("id",u),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",this.iframe=document.getElementsByTagName("body")[0].appendChild(r)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+u+'" id="'+u+'" style="border:1px solid black;display:none"><\/iframe>'),window.frames&&window.frames[u]&&(this.iframe=window.frames[u]),this.iframe.name=u,this.iframe.document.open(),this.iframe.document.write("<html><body><\/body><\/html>"),this.iframe.document.close());this.method=n;this.url=t;this.async=i},setRequestHeader:function(n,t){for(var i=0;i<this.headers.length;i++)if(this.headers[i].name==n){this.headers[i].value=t;return}this.headers.push({name:n,value:t})},getResponseHeader:function(){return null},addInput:function(n,t,i,r){var u,f="input";r.indexOf("\n")>=0&&(f="textarea");n.all?u=n.createElement("<"+f+' name="'+i+'" />'):(u=n.createElement(f),u.setAttribute("name",i));u.setAttribute("value",r);t.appendChild(u);u=null},send:function(n){var r,t,i;if(this.iframe!=null){for(r=this.iframe.contentDocument||this.iframe.document,t=r.createElement("form"),r.body.appendChild(t),t.setAttribute("action",this.url),t.setAttribute("method",this.method),t.setAttribute("enctype","application/x-www-form-urlencoded"),i=0;i<this.headers.length;i++)switch(this.headers[i].name.toLowerCase()){case"content-length":case"accept-encoding":case"content-type":break;default:this.addInput(r,t,this.headers[i].name,this.headers[i].value)}this.addInput(r,t,"data",n);t.submit();setTimeout(this.readystatechanged.bind(this),0)}}},progids=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],progid=null,typeof ActiveXObject!="undefined"){if(ie7xmlhttp=!1,typeof XMLHttpRequest=="object")try{o=new XMLHttpRequest;ie7xmlhttp=!0}catch(e){}typeof XMLHttpRequest!="undefined"&&ie7xmlhttp||(XMLHttpRequest=function(){var t=null,n;if(!AjaxPro.noActiveX){if(progid!=null)return new ActiveXObject(progid);for(n=0;n<progids.length&&t==null;n++)try{t=new ActiveXObject(progids[n]);progid=progids[n]}catch(i){}}return t==null&&MS.Browser.isIE?new AjaxPro.IFrameXmlHttp:t})}Object.extend(AjaxPro,{noOperation:function(){},onLoading:function(){},onError:function(){},onTimeout:function(){return!0},onStateChanged:function(){},cryptProvider:null,queue:null,token:"",version:"{AssemblyVersion}",ID:"AjaxPro",noActiveX:!1,timeoutPeriod:15e3,queue:null,noUtcTime:!1,regExDate:function(n){var t=n.substring(1).replace('"',""),i;return t.substring(0,7)=="\\/Date("?(i=t.match(/Date\((.*?)\)/)[1],"new Date("+parseInt(i)+")"):n},parse:function(n){return n=n.replace(/(\"\\\/Date\(\d+\)\\\/")/g,this.regExDate),eval("("+n+")")},m:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},toJSON:function(n){var t,r,i,u;if(n==null)return"null";if(t=[],i=n.constructor,i==Number)return isFinite(n)?n.toString():AjaxPro.toJSON(null);if(i==Boolean)return n.toString();if(i==String)return/["\\\x00-\x1f]/.test(n)&&(n=n.replace(/([\x00-\x1f\\"])/g,function(n,t){var i=AjaxPro.m[t];return i?i:(i=t.charCodeAt(),"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16))})),'"'+n+'"';if(i==Array){for(r=0;r<n.length;r++)t.push(AjaxPro.toJSON(n[r]));return"["+t.join(",")+"]"}if(i==Date)return AjaxPro.toJSON("/Date("+new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())).getTime()+")/");if(typeof n.toJSON=="function")return n.toJSON();if(typeof n=="object"){for(u in n)typeof n[u]!="function"&&t.push('"'+u+'":'+AjaxPro.toJSON(n[u]));return t.length>0?"{"+t.join(",")+"}":"{}"}return n.toString()},dispose:function(){AjaxPro.queue!=null&&AjaxPro.queue.dispose()}},!1);addEvent(window,"unload",AjaxPro.dispose);AjaxPro.Request=function(n){this.url=n;this.xmlHttp=null};AjaxPro.Request.prototype={url:null,callback:null,onLoading:null,onError:null,onTimeout:null,onStateChanged:null,args:null,context:null,isRunning:!1,abort:function(){if(this.timeoutTimer!=null&&clearTimeout(this.timeoutTimer),this.xmlHttp&&(this.xmlHttp.onreadystatechange=AjaxPro.noOperation,this.xmlHttp.abort()),this.isRunning&&(this.isRunning=!1,this.onLoading!==null))this.onLoading(!1)},dispose:function(){this.abort()},getEmptyRes:function(){return{error:null,value:null,request:{method:this.method,args:this.args},context:this.context,duration:this.duration}},endRequest:function(n){if(this.abort(),n.error!=null)this.onError(n.error,this);typeof this.callback=="function"&&this.callback(n,this)},mozerror:function(){this.timeoutTimer!=null&&clearTimeout(this.timeoutTimer);var n=this.getEmptyRes();n.error={Message:"Unknown",Type:"ConnectFailure",Status:0};this.endRequest(n)},doStateChange:function(){this.onStateChanged(this.xmlHttp.readyState,this);if(this.xmlHttp.readyState==4&&this.isRunning){this.duration=(new Date).getTime()-this.__start;this.timeoutTimer!=null&&clearTimeout(this.timeoutTimer);var n=this.getEmptyRes();this.xmlHttp.status!=200&&this.xmlHttp.statusText?(n=this.createResponse(n,!0),n.error={Message:this.xmlHttp.statusText,Type:"ConnectFailure",Status:this.xmlHttp.status}):n=this.createResponse(n);this.endRequest(n)}},createResponse:function(n,t){var i,r;if(!t){if(typeof this.xmlHttp.responseText=="unknown")return n.error={Message:"XmlHttpRequest error reading property responseText.",Type:"XmlHttpRequestException"},n;i=""+this.xmlHttp.responseText;AjaxPro.cryptProvider!=null&&typeof AjaxPro.cryptProvider.decrypt=="function"&&(i=AjaxPro.cryptProvider.decrypt(i));this.xmlHttp.getResponseHeader("Content-Type")=="text/xml"?n.value=this.xmlHttp.responseXML:i!=null&&i.trim().length>0&&(n.json=i,r=null,r=AjaxPro.parse(i),r!=null&&(typeof r.value!="undefined"?n.value=r.value:typeof r.error!="undefined"&&(n.error=r.error)))}return n},timeout:function(){if(this.duration=(new Date).getTime()-this.__start,this.onTimeout==null||typeof this.onTimeout!="function")this.abort();else{var n=this.onTimeout(this.duration,this);typeof n=="undefined"||n!=!1?this.abort():this.timeoutTimer=setTimeout(this.timeout.bind(this),AjaxPro.timeoutPeriod)}},invoke:function(n,t,i,r){var u,f;if(this.__start=(new Date).getTime(),this.xmlHttp=new XMLHttpRequest,this.isRunning=!0,this.method=n,this.args=t,this.callback=i,this.context=r,u=typeof i=="function"&&i!=AjaxPro.noOperation,u){MS.Browser.isIE?this.xmlHttp.onreadystatechange=this.doStateChange.bind(this):(this.xmlHttp.onload=this.doStateChange.bind(this),this.xmlHttp.onerror=this.mozerror.bind(this));this.onLoading(!0)}f=AjaxPro.toJSON(t)+"";AjaxPro.cryptProvider!=null&&typeof AjaxPro.cryptProvider.encrypt=="function"&&(f=AjaxPro.cryptProvider.encrypt(f));this.xmlHttp.open("POST",this.url,u);this.xmlHttp.setRequestHeader("Content-Type","text/plain; charset=utf-8");this.xmlHttp.setRequestHeader("X-"+AjaxPro.ID+"-Method",n);AjaxPro.token!=null&&AjaxPro.token.length>0&&this.xmlHttp.setRequestHeader("X-"+AjaxPro.ID+"-Token",AjaxPro.token);this.timeoutTimer=setTimeout(this.timeout.bind(this),AjaxPro.timeoutPeriod);try{this.xmlHttp.send(f)}catch(e){}return u?!0:this.createResponse({error:null,value:null})}};AjaxPro.RequestQueue=function(n){this.queue=[];this.requests=[];this.timer=null;isNaN(n)&&(n=2);for(var t=0;t<n;t++)this.requests[t]=new AjaxPro.Request,this.requests[t].callback=function(n){var t=n.context;n.context=t[3][1];t[3][0](n,this)},this.requests[t].callbackHandle=this.requests[t].callback.bind(this.requests[t]);this.processHandle=this.process.bind(this)};AjaxPro.RequestQueue.prototype={process:function(){var t,n;if(this.timer=null,this.queue.length!=0){for(t=0;t<this.requests.length&&this.queue.length>0;t++)this.requests[t].isRunning==!1&&(n=this.queue.shift(),this.requests[t].url=n[0],this.requests[t].onLoading=n[3].length>2&&n[3][2]!=null&&typeof n[3][2]=="function"?n[3][2]:AjaxPro.onLoading,this.requests[t].onError=n[3].length>3&&n[3][3]!=null&&typeof n[3][3]=="function"?n[3][3]:AjaxPro.onError,this.requests[t].onTimeout=n[3].length>4&&n[3][4]!=null&&typeof n[3][4]=="function"?n[3][4]:AjaxPro.onTimeout,this.requests[t].onStateChanged=n[3].length>5&&n[3][5]!=null&&typeof n[3][5]=="function"?n[3][5]:AjaxPro.onStateChanged,this.requests[t].invoke(n[1],n[2],this.requests[t].callbackHandle,n),n=null);this.queue.length>0&&this.timer==null&&(this.timer=setTimeout(this.processHandle,0))}},add:function(n,t,i,r){this.queue.push([n,t,i,r]);this.timer==null&&(this.timer=setTimeout(this.processHandle,0))},abort:function(){this.queue.length=0;this.timer!=null&&clearTimeout(this.timer);this.timer=null;for(var n=0;n<this.requests.length;n++)this.requests[n].isRunning==!0&&this.requests[n].abort()},dispose:function(){for(var t,n=0;n<this.requests.length;n++)t=this.requests[n],t.dispose();this.requests.clear()}};AjaxPro.queue=new AjaxPro.RequestQueue(2);AjaxPro.AjaxClass=function(n){this.url=n};AjaxPro.AjaxClass.prototype={invoke:function(n,t,i){var r,u;if(i!=null){if(i.length!=6)for(;i.length<6;)i.push(null);if(i[0]!=null&&typeof i[0]=="function")return AjaxPro.queue.add(this.url,n,t,i)}return r=new AjaxPro.Request,r.url=this.url,u=r.invoke(n,t),r.abort(),u}};